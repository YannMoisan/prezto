# Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc.
# Initialization code that may require console input (password prompts, [y/n]
# confirmations, etc.) must go above this block; everything else may go below.
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

#
# Executes commands at the start of an interactive session.
#
# Authors:
#   Sorin Ionescu <sorin.ionescu@gmail.com>
#

# Source Prezto.
if [[ -s "${ZDOTDIR:-$HOME}/.zprezto/init.zsh" ]]; then
  source "${ZDOTDIR:-$HOME}/.zprezto/init.zsh"
fi

# Customize to your needs...

# Add an "alert" alias for long running commands.  Use like so:
#   sleep 10; alert
alias alert='notify-send --urgency=low -i "$([ $? = 0 ] && echo terminal || echo error)" "$(history|tail -n1|sed -e '\''s/^\s*[0-9]\+\s*//;s/[;&|]\s*alert$//'\'')"'

CDPATH=.:~:/mnt/data/backup/dev/projects/

if [[ $(uname -s) == "Darwin" ]]; then
    DOTFILES=~/projects/dotfiles
else 
    DOTFILES=/mnt/data/backup/dev/projects/dotfiles
fi

export PATH=$DOTFILES/bin:$PATH
SPARK_DIR=~/opt/spark
export PATH=$SPARK_DIR/bin:$PATH
export PATH=~/opt/bin:$PATH

function cl() {
    echo "$1" >> $DOTFILES/bin/yamocl.txt
}

alias cat='bat'
alias drmi='docker rmi $(docker images --filter "dangling=true" -q --no-trunc)'
alias du="ncdu --color dark"
alias dush="du -sh | sort -h | tail"
alias h=history
alias penguen="ssh penguen -t tmux a"
alias projects="cd ~/projects"
alias rr='ranger'
alias todo="vim ~/Dropbox/Documents/TODO.txt"
alias tv="vlc http://mafreebox.freebox.fr/freeboxtv/playlist.m3u"
alias history-clean="history 1 | sed 's/^[ ]*[^ ]*[ ]*//'"

# https://github.com/StreakyCobra/gws/issues/17
alias gws="PATH=/usr/local/opt/coreutils/libexec/gnubin:usr/local/opt/gnu-sed/libexec/gnubin:$PATH gws"

# added by travis gem
[ -f /Users/yamo/.travis/travis.sh ] && source /Users/yamo/.travis/travis.sh

#https://github.com/pstadler/keybase-gpg-github/issues/11
GPG_TTY=$(tty)
export GPG_TTY

[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh
alias v='open "$(fd . --type f ~/videos | fzf)"'

# The next line updates PATH for the Google Cloud SDK.
if [ -f '/Users/yann.moisan/opt/google-cloud-sdk/path.zsh.inc' ]; then . '/Users/yann.moisan/opt/google-cloud-sdk/path.zsh.inc'; fi

# The next line enables shell command completion for gcloud.
if [ -f '/Users/yann.moisan/opt/google-cloud-sdk/completion.zsh.inc' ]; then . '/Users/yann.moisan/opt/google-cloud-sdk/completion.zsh.inc'; fi

# Teads
export COURSIER_REPOSITORIES="ivy2Local|central|https://nexus.teads.net/content/repositories/releases|https://nexus.teads.net/content/repositories/snapshots"
export COURSIER_TTL=0s

[ -f /usr/local/share/zsh/site-functions/aws_zsh_completer.sh ] && source /usr/local/share/zsh/site-functions/aws_zsh_completer.sh
function mig() { touch $(date +"V%Y%m%d%H%M__$1.sql") }

alias javals='/usr/libexec/java_home -V' #osx
export JAVA_HOME="$(/usr/libexec/java_home -v '13*')"

function j8() {
    export JAVA_HOME="$(/usr/libexec/java_home -v '1.8*')"
}
function j11() {
    export JAVA_HOME="$(/usr/libexec/java_home -v 'Zulu 11')"
}

alias redis-cli-eu='redis-cli -c -h be-lookalike-cluster.srwool.clustercfg.euw1.cache.amazonaws.com -p 6379'
alias redis-cli-us='redis-cli -c -h be-lookalike-cluster.rgzmow.clustercfg.use1.cache.amazonaws.com -p 6379'
alias redis-cli-ap='redis-cli -c -h be-lookalike-cluster.rgpv3r.clustercfg.apne1.cache.amazonaws.com -p 6379'

alias crane="teads-central crane wrapper"
alias coursier_update='curl -Lo ~/opt/bin/coursier https://git.io/coursier-cli'

REPOS="http://nexus.teads.net/content/repositories/releases,\
http://nexus.teads.net/content/repositories/snapshots,\
https://dl.bintray.com/scalaz/releases,\
https://oss.sonatype.org/content/repositories/releases,\
http://redshift-maven-repository.s3-website-us-east-1.amazonaws.com/release"

function spl() {
    aws s3 cp "s3://teads-hadoop/engine/spark-logs/${1}_1" $SPARK_DIR/history/
}
function spi() {
  wget http://repo1.maven.org/maven2/org/apache/hadoop/hadoop-aws/2.7.1/hadoop-aws-2.7.1.jar
  wget http://repo1.maven.org/maven2/com/amazonaws/aws-java-sdk/1.7.4/aws-java-sdk-1.7.4.jar
}

# To customize prompt, run `p10k configure` or edit ~/.p10k.zsh.
[[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh
