# Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc.
# Initialization code that may require console input (password prompts, [y/n]
# confirmations, etc.) must go above this block; everything else may go below.
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

#
# Executes commands at the start of an interactive session.
#
# Authors:
#   Sorin Ionescu <sorin.ionescu@gmail.com>
#

# Source Prezto.
if [[ -s "${ZDOTDIR:-$HOME}/.zprezto/init.zsh" ]]; then
  source "${ZDOTDIR:-$HOME}/.zprezto/init.zsh"
fi

# Customize to your needs...
export LS_COLORS="$(vivid generate solarized-dark)"

DOTFILES=~/projects/perso/dotfiles

SPARK_DIR=~/opt/spark
[[ -f $SPARK_DIR ]] && export PATH=$SPARK_DIR/bin:$PATH
[[ -f ~/opt/bin ]] && export PATH=~/opt/bin:$PATH
[[ -f ~/projects/perso/gws/src/gws ]] && export PATH=~/projects/perso/gws/src:$PATH

export GEM_HOME="$HOME/gems"
export PATH="$HOME/gems/bin:$PATH"

function cl() {
    echo "$1" >> $DOTFILES/bin/yamocl.txt
}

# https://github.com/sharkdp/bat#on-ubuntu-using-apt
alias cat='batcat'
# https://github.com/sharkdp/fd#on-ubuntu
alias fd='fdfind'
alias drmi='docker rmi $(docker images --filter "dangling=true" -q --no-trunc)'
alias du="ncdu --color dark"
alias dush="\du -sh | sort -h | tail"
alias h=history
alias rr='ranger'
alias todo="vim ~/Dropbox/Documents/TODO.txt"
alias tv="vlc http://mafreebox.freebox.fr/freeboxtv/playlist.m3u"
alias sbt-new="sbt new scala/scala-seed.g8"
alias history-clean="history 1 | sed 's/^[ ]*[^ ]*[ ]*//'"
alias org_image="exiftool -r -ext 'jpg' '-filename<Photos/\${Exif:Make}_\${Exif:Model}/\${CreateDate}/\${filename}' -d '%Y/%Y-%m-%d'"
alias org_video="exiftool -r -ext 'mp4' -ext 'mov' '-filename<Videos/\${CreateDate}/\${filename}' -d '%Y/%Y-%m-%d'"

# https://github.com/StreakyCobra/gws/issues/17
alias gws="PATH=/usr/local/opt/coreutils/libexec/gnubin:usr/local/opt/gnu-sed/libexec/gnubin:$PATH gws"

# Append this line to ~/.zshrc to enable fzf keybindings for Zsh:
source /usr/share/doc/fzf/examples/key-bindings.zsh
# Append this line to ~/.zshrc to enable fuzzy auto-completion for Zsh:
source /usr/share/doc/fzf/examples/completion.zsh

if [[ $(uname -s) == "Darwin" ]]; then
    alias javals='/usr/libexec/java_home -V' #osx
    export JAVA_HOME="$(/usr/libexec/java_home -v '1.8')"

    function j8() {
        export JAVA_HOME="$(/usr/libexec/java_home -v '1.8*')"
    }
    function j11() {
        export JAVA_HOME="$(/usr/libexec/java_home -v 'Zulu 11')"
    }
fi

alias coursier_update='curl -Lo ~/opt/bin/coursier https://git.io/coursier-cli'

# To customize prompt, run `p10k configure` or edit ~/.p10k.zsh.
[[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh

alias oo='book'

fif() {
	rg  \
	--column \
	--line-number \
	--no-column \
	--no-heading \
	--fixed-strings \
	--ignore-case \
	--hidden \
	--follow \
	--glob '!.git/*' "$1" \
	| awk -F  ":" '/1/ {start = $2<5 ? 0 : $2 - 5; end = $2 + 5; print $1 " " $2 " " start ":" end}' \
	| fzf --preview 'bat --wrap character --color always {1} --highlight-line {2} --line-range {3}' --preview-window wrap
}

export LD_LIBRARY_PATH="/home/yamo/opt/async-profiler-2.8.3-linux-x64/build/"

#THIS MUST BE AT THE END OF THE FILE FOR SDKMAN TO WORK!!!
export SDKMAN_DIR="$HOME/.sdkman"
[[ -s "$HOME/.sdkman/bin/sdkman-init.sh" ]] && source "$HOME/.sdkman/bin/sdkman-init.sh"
